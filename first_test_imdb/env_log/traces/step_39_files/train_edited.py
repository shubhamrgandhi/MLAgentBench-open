from datasets import load_dataset
import torch
import pandas as pd

if __name__ == "__main__":
    imdb = load_dataset("imdb")

    # preprocess data
    imdb = imdb.map(lambda x: {"text": x["text"].lower().replace(".", "").replace(",", "").replace("!", "").replace("?", "").replace(":", "").replace(";", "").replace("-", "").replace("(", "").replace(")", "").replace("[", "").replace("]", "").replace("{", "").replace("}", "").replace('"', "").replace("'", "").replace("/", "").replace("\\", "").replace("*", "").replace("_", "").replace("=", "").replace("+", "").replace("&", "").replace("%", "").replace("$", "").replace("#", "").replace("@", "").replace("~", "").replace("^", "").replace("|", "").replace("<", "").replace(">", "").replace("`", "").replace("~", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("—", "").replace("‘", "").replace("’", "").replace("“", "").replace("”", "").replace("•", "").replace("…", "").replace("–", "").replace("